# 时空注意力长短期记忆网络

### 传统评估方法的缺陷

* 耗费资源人力
* 受观察者、伤员因素影响
* 评估困难，需要训练

实验在新加坡两家医疗机构进行（妇女、儿童医院，时间2022.5-202312），

### 实验过程

**被试**：21-70岁接受外科手术或者介入疼痛治疗的成年住院病人或者出院病人。（异常样本已排除）

#### **数据处理**：

* 将实验视频划分为1s片段
* 疼痛等级划分为三等级
  * 无疼痛（NRS 0）
  * 中等疼痛（NRS 1-3）
  * 中毒疼痛（NRS 4-10）
* 视频流提取468个面部关键特征点，30帧视频流每秒包括14040关键点。
* 使用3D正常化算法避免不同拍摄角度对实验的影响，利用面部关键点左眼角、右眼角和鼻下充当面部关键点。
* 最后将数据转化为1D数组。

#### 时空注意力长短期记忆（STA-LSTM）模型的训练和验证

长短期记忆（LSTM）是一种循环神经网络。

应用时空注意力（STA）实现对多帧数据的处理。

没有预处理或人造数据的输入。

#### 实验设备

Windows 10、Intel Xeon Silver 4208 processor (8 cores, 3.2 GHz)、64 GBRAM、两块Nvidia RTX 2080 Ti 

#### 模型验证

至少可以使用1000段数据进行学习实现对大型数据集的良好检测（University of Northern British Columbia (UNBC)-McMaster Shoulder Pain Expression Archive Database,北英国大学哥伦比亚大学(UNBC)-麦克马斯特肩部疼痛表达档案数据库，）准确率达到百分之九十五以上。

### 结果

对于收集道德视频数据，90.4%无疼痛，3.4%重度疼痛，6.3%中等疼痛。

直接使用该数据会导致模型在疼痛样本中性能较差。使用自适应步长重采样技术进行平衡：对于无疼痛使用较长步长进行采样，疼痛使用较短步长。

![image-20250515092855605](C:\Users\MI\AppData\Roaming\Typora\typora-user-images\image-20250515092855605.png)

### 讨论

* 没有讨论性别差异

* 本研究使用观察者评分量表对1秒视频片段进行标注，以模拟基于观察者的视觉评估。
* 采用自适应步幅采样方法增加训练实例数量，而非人工生成数据。
* 首个在面部疼痛识别中应用STA-LSTM模型的研究。多种深度学习模型（包括STA-LSTM、LSTM、CNN-LSTM和3D CNN），其中STA-LSTM表现最佳。
* 此前研究多基于健康志愿者或轻微疼痛患者的数据库（如UNBC-McMaster肩痛数据库），而本研究模型在真实临床场景中表现出竞争力。
* 自动化疼痛评估平台尚未在临床实践中广泛应用。已将STA-LSTM模型集成至PC软件，可实时显示疼痛水平分布。

### 局限

1. **人群局限性**：数据集主要来自新加坡多民族亚洲人群，且近半数患者为慢性疼痛，可能影响疼痛表达和报告的普适性[55,56]。
2. **样本量限制**：显著疼痛和轻度疼痛的视频数量有限，可能降低模型对这两类的敏感性。未来需纳入更广泛的手术类型（如胸腹部手术）以丰富数据集。
3. **观察者评分偏差**：模型训练依赖观察者标注，可能引入主观偏差，需结合患者实际疼痛体验优化。
4. **未探索子组差异**：因样本量不足，未分析性别、手术类型等子组差异。
5. **泛化性挑战**：AI模型可能继承训练数据的偏差，需通过公平性训练和领域适应技术提升泛化能力[57,58]。

*数据集不公开*